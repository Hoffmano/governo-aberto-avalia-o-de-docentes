(window.webpackJsonp=window.webpackJsonp||[]).push([["infogram-charts/charts-area~infogram-charts/charts-area_stacked~infogram-charts/charts-area_stacked_~cd98196a"],{"/6f4":function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return s});var i=a("JPcv"),n=a("ZBKM");function s(e){if(e.get("isFreelayoutInline")){var t=Object(i.fromJS)(e.attributes);t=t.withMutations(function(e){if(e.delete("chart_id"),e.delete("isFreelayoutInline"),e.delete("template"),e.delete("dataSets"),e.delete("interlinkedCharts"),e.delete("tabs"),e.deleteIn(["custom","height"]),e.deleteIn(["custom","viewMode"]),e.deleteIn(["custom","map_json"]),e.deleteIn(["custom","yminraw"]),e.deleteIn(["custom","ymaxraw"]),e.deleteIn(["custom","xminraw"]),e.deleteIn(["custom","xmaxraw"]),e.deleteIn(["custom","y2minraw"]),e.deleteIn(["custom","y2maxraw"]),e.deleteIn(["custom","pointSizeminraw"]),e.deleteIn(["custom","pointSizemaxraw"]),e.deleteIn(["custom","dataPointRadiusRangemaxraw"]),e.deleteIn(["custom","dataPointRadiusRangeminraw"]),e.get("sheets_settings"))for(var t=0;t<e.get("sheets_settings").size;t++){e.getIn(["sheets_settings",t])&&(e.deleteIn(["sheets_settings",t,"yminraw"]),e.deleteIn(["sheets_settings",t,"ymaxraw"]),e.deleteIn(["sheets_settings",t,"xminraw"]),e.deleteIn(["sheets_settings",t,"xmaxraw"]),e.deleteIn(["sheets_settings",t,"y2minraw"]),e.deleteIn(["sheets_settings",t,"y2maxraw"]),e.deleteIn(["sheets_settings",t,"pointSizeminraw"]),e.deleteIn(["sheets_settings",t,"pointSizemaxraw"]),e.deleteIn(["sheets_settings",t,"dataPointRadiusRangemaxraw"]),e.deleteIn(["sheets_settings",t,"dataPointRadiusRangeminraw"]))}}),Object(n.default)(e.get("chart_id"),t,e)}}},"0Qba":function(e,t,a){"use strict";a.r(t),function(e){var i=a("LvDl"),n=a.n(i),s=a("gUtP"),r={load:function(t,a){var i=t.split(","),o=r.shapes;if(window.inlineShapes&&n.a.each(i,function(e){var t="".concat(e,"Path");window.inlineShapes[t]&&(o[t]=window.inlineShapes[t])}),(t=i.filter(function(e){if(!o["".concat(e,"Path")])return e})).length){if(window.app.crm)return e.get("".concat(s.default.apiBase,"/shapes/342,454"),n.a.bind(function(e){e&&n.a.each(e,function(e){var t="".concat(e.title,"Path");o[t]={dimensions:e.dimensions,searchkey:e.searchkey,path:e.path,title:t}})},this),"json").then(a);var c=e.get("".concat(s.default.apiBase,"/shapes/").concat(n.a.uniq(t).join(",")),n.a.bind(function(e){e&&n.a.each(e,function(e){var t="".concat(e.title,"Path");o[t]={dimensions:e.dimensions,searchkey:e.searchkey||e.title,path:e.path,title:t}})},this),"json");return c.then(a),c}a()},shapes:{},getShapes:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t=t.toLowerCase();var i=r.shapes,s=a?{}:[];return Object.keys(i).forEach(function(r){var o=i[r],c=!0;if(t&&-1===o.searchkey.toLowerCase().indexOf(t)?c=!1:e&&o.usergroup!==e&&(c=!1),n.a.get(o,"dimensions.width")){var l=Math.max((32-o.dimensions.width)/2,0),h=Math.max((32-o.dimensions.height)/2,0),u={transform:"translate(".concat(l," ").concat(h,")")};o=n.a.extend(o,u)}c&&(a?s[r]=o:s.push(o))}),s}};t.default=r}.call(this,a("+hRF"))},"474q":function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return r});var i=a("LvDl"),n=a.n(i),s=a("Z8Pq");function r(e){var t=e.options,a=e.emptySheet,i=e.createNumberParser,r=Object(s.createExtractCell)(t);function o(r,o){var c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=n.a.merge({},a),h=n.a.merge({},l.series[0]),u=c?r.map(function(e){return e[0]}):r[0]||[],f=t.sheetnames&&t.sheetnames[o],d=i.call(e,o+1);l.series=[],l.categories.data=[],l.categories.title=Object(s.replaceBlank)(f||u[0]);var p=function(e,t){var a=[];return function(i){var s,r=a.indexOf(i);if(-1===r){var o=a.length;a.push(i),s=function(e){return e.data=e.data||[],e.rawData=e.rawData||[],e.links=e.links||[],e}(n.a.merge({},t,{title:i,type:"line-area",index:o})),e.series.push(s)}else s=e.series[r];return s}}(l,h),g=Object(s.categoryHelper)(l);return t.sheets.push(l),function(e,t,a,i){return function(n){var r=n.row,o=n.link,c=r[0],l=r[1],h=r[2],u=r[3],f=Object(s.replaceBlank)(r[4]),d=e(f),p=t(c),g=[Number(a(l)),Number(a(h)),Number(a(u))],m=[l,h,u];d.data[p]=g,d.rawData[p]=m,d.dataLabels=[i[1],i[2],i[3]],d.links.push(o)}}(p,g,d,u)}return{default:Object(s.createImportFn)(function(e,t){var a=o(e,t);e.forEach(function(e,t){0!==t&&a(Object(s.getRowValuesAndLink)(e,r))})}),transposed:Object(s.createImportFn)(function(e,t){for(var a=o(e,t,!0),i=Object(s.getMaxColCount)(e),c=[],l=1;l<i;l++){for(var h=[],u=0;u<5;u++){var f=n.a.get(e,"[".concat(u,"][").concat(l,"]"));h.push(f)}c.push(h)}c.forEach(function(e){a(Object(s.getRowValuesAndLink)(e,r))})})}}},"6jAQ":function(e,t,a){"use strict";a.r(t),function(e){a.d(t,"getChartType",function(){return I});var i=a("XzT5"),n=a("LvDl"),s=a.n(n),r=a("SC+/"),o=a("rxf+"),c=a("wrGL"),l=a("ibon"),h=a("JnWj"),u=a("pLmG"),f=a("0Qba"),d=a("/6f4"),p=a("6LTm"),g=a("tcv8"),m=a("S99L"),v=a("Oq5T"),b=a("wUcv"),y=a("SdvQ"),O=a("h7h9"),x=a("pWQL");function S(e,t,a,i,n,s,r){try{var o=e[s](r),c=o.value}catch(e){return void a(e)}o.done?t(c):Promise.resolve(c).then(i,n)}function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e,t){for(;t.firstChild;)t.removeChild(t.firstChild);Object(O.removeEntity)(e)}function I(e){return(e.getChartInstance()||e).chart.getTypeMod()}function C(e,t){var a=t.decimalSeparator,i=t.groupingSymbol,n=t.decimalPlaces,r=t.decimalPlacesValue;i&&s.a.set(e,"grouping","none"===i?"":i);var o=!1===a;s.a.set(e,"decimal",o?".,":a),s.a.set(e,"numberParser",new h.default(o?"legacy":"firstNumber",a)),n&&void 0!==r&&s.a.set(e,"decimalPlaces",r)}var E=[".,",".",","],j=[x.PICTORIAL_GRID,x.PICTORIAL_SIZE,x.MAP,x.TABLE,x.PICTORIAL_BAR,x.FACTS_AND_FIGURES],T=[x.MAP,x.TABLE,x.FACTS_AND_FIGURES],D=["edit","capture","download"];function N(e){switch(e){case x.PICTORIAL_GRID:case x.PICTORIAL_SIZE:case x.GAUGE:return 250;case x.PICTORIAL_BAR:case x.TIMER:case x.BAR_PROGRESS:return 70;default:return 400}}t.default={instanceClass:null,defaultHeight:400,defaultCategoryHeight:40,defaultCategoryWidth:40,defaultShape:"boyPath",initialize:function(e){var t=this;return this.initVariables(e),this.loadingShapes&&this.cleanup(),this.loadShapes().then(function(){return t.setupChartOptions(),t.setupChartOptionsStyle(),t.setupChartOptionsCustomStyle(),t.createInstance()})},loadShapes:function(){var t=this,a=e.Deferred(),i=this.custom,n=this.chart.getTypeMod(),r=[];if(-1!==j.indexOf(n)){if(n===x.FACTS_AND_FIGURES){var o=/^[a-zA-Z0-9-_]+$/;this.chart.get("data").forEach(function(e){e.forEach(function(e){if(e&&e[2]){var t="string"==typeof e[2]?e[2]:"";s.a.has(e,"[2].value")&&(t=e[2].value);var a=t.toString().trim();(function(e){return o.lastIndex=0,!(!e||e.length>64)&&o.test(e)})(a)&&r.push(a)}})})}else{var c="defaultPath";switch(n){case x.PICTORIAL_SIZE:i[c]=i[c]||"circlePath";break;case x.MAP:i[c="path"]=i[c]||"circlePath";break;case x.TABLE:i[c]=i[c]||"circlePath";break;case x.PICTORIAL_BAR:c="path"}r=[s.a.has(i,c)&&i[c]||"boy"],i.shapes&&(r=r.concat(i.shapes)),this.sheetSettings&&this.sheetSettings.forEach(function(e){e&&e[c]&&r.push(e[c]),e&&e.shapes&&(r=r.concat(e.shapes))})}if(n===x.TABLE)this.chart.get("data").forEach(function(e){e.forEach(function(e){e.forEach(function(e){(e=Object(v.default)(e)).shape&&r.push(e.shape)})})});var l=s.a.map(r,function(e){return e?e.replace("Path",""):""});this.loadingShapes=f.default.load(l.join(","),function(){a.resolve(),t.loadingShapes=void 0})}else a.resolve();return a},cancelRender:function(){this.delayedRender&&("embed"===this.viewMode||"web"===this.viewMode?cancelAnimationFrame(this.delayedRender):clearTimeout(this.delayedRender),this.delayedRender=null)},initVariables:function(e){var t=e.chart,a=e.theme,i=e.id,n=e.sheetIndex,r=e.data,o=e.tabs,c=e.freeLayout,l=e.disableColumnSheets,h=e.interactivityHintEnabled,u=e.editable,f=e.viewMode,d=e.downloadMode,p=e.scale,g=e.observer,m=e.container,v=e.animate,b=void 0===v||v;this.chart=t,this.theme=a,this.id=i||t.get("chart_id"),this.sheetIndex=n,this.initializeData(r||t.get("data")),this.custom=t.get("custom"),this.colors=t.get("colors"),this.sheetSettings=t.get("sheets_settings"),this.themeColors=a.get("colors")||[],this.themeFont=a.get("font")||{},this.themeStyleColor=a.get("color")||{},this.charts=a.get("charts"),this.displayTabs=!!o,this.freeLayout=!!c,this.disableColumnSheets=!!l,this.interactivityHintEnabled=h,this.observer=g,this.editable=u,this.viewMode=f,this.downloadMode=d,this.scale=p,this.container=m,this.animate=!0===b&&s.a.get(this.custom,"animation.enabled",!0),t.view&&t.view.infographic&&(this.infographic=t.view.infographic),0===this.colors.length&&t.getTypeMod()!==x.TABLE&&(this.colors=this.themeColors.slice(0))},initializeData:function(e){e.forEach(function(t,a){t&&t.length||(t=e[a]=[[]]),s.a.isArray(t[0])||(t[0]=[])}),this.data=e},setupChartOptions:function(){var e=this.animate,t=this.chart,a=this.charts,n=this.custom,r=this.displayTabs,o=this.downloadMode,c=this.instanceClass,l=this.freeLayout,h=this.editable,f=this.container,d=this.chartOptions=c.prototype.defaults();n.viewMode=t.view?t.view.parent.viewMode:o?"capture":"freeLayout",d.sheetnames=t.get("sheetnames"),d.sheetOptions=this.setupChartSheetOptions(),d.container=f,d.fixedHeight=l,d.editable=h,d.scale={x:s.a.get(this,"scale.x",1),y:s.a.get(this,"scale.y",1)},this.setupChartOptionsDimensions(),s.a.set(d,"tooltip.enabled",s.a.get(n,"tooltip.enabled",!0));var p=(s.a.get(n,"showSheetPlayer")?"player":r&&"tab")||"radio";s.a.set(d,"sheetSwitch.enabled",!0),s.a.set(d,"sheetSwitch.type",p),s.a.merge(d.sheetSwitch.tabOptions,s.a.get(a,"sheetSwitch.tabOptions",{})),s.a.has(n,"shrink")&&n.shrink>0&&(d.width=u.default.chartWidth(n.shrink),d.container.style.width="".concat(d.width,"px")),d.downloadText=s.a.get(n,"showDownload")&&(i.default.t("table.download_data")||"Download data"),e||s.a.set(d,"animation.duration",0)},setupChartSheetOptions:function(){var e=this.sheetSettings,t=this.custom;t&&s.a.has(t,"colors")&&delete t.colors;var a=s.a.omit(t,"map_json"),i=e&&e.length,n=[this.setupChartSheetOptionsItem(s.a.merge({},a))];if(i)for(var r=0;r<i;r++){var o=s.a.merge({},a,e[r]);n.push(this.setupChartSheetOptionsItem(o,r))}return n},sheetOptionsItemDefaults:function(e){var t=this.getGridSettings(e),a=t.vertical,i=t.horizontal,n=this.getZeroBaseline(e),r=n.verticalZero,o=n.horizontalZero,c={categories:{colors:s.a.merge([],this.themeColors,e.colors||this.colors)},series:[{}],grid:{vertical:a,horizontal:i,verticalZero:r,horizontalZero:o},axis:[{},{}]};return this.setupLegend(c,e),c},setupChartSheetOptionsItem:function(e){return{categories:{colors:s.a.merge([],this.themeColors,e.colors||this.colors)},grid:{},axis:[{}]}},setupLegend:function(e,t){e.legend={enabled:!1!==t.showLabels,position:s.a.get(t,"labels.legend.position",s.a.get(this,"charts.legend.position","bottom")),align:s.a.get(t,"labels.legend.align",s.a.get(this,"charts.legend.align","top")),layouts:s.a.get(this,"charts.legend.layouts",{})}},addPx:function(e){return e+(/px/.test(e)?"":"px")},getGridSettings:function(e){var t=s.a.get(e,"axis.x.grid"),a=s.a.get(e,"axis.y.grid");if(void 0===t&&void 0===a){var i=!1!==e.grid;t=i,a=i}return{vertical:t,horizontal:a}},getGridSettingsHorizontal:function(e){var t=s.a.get(e,"axis.y.grid");return void 0===t&&!1===e.grid&&(t=!1),t},getGridSettingsVertical:function(e){var t=s.a.get(e,"axis.x.grid");return void 0===t&&!1===e.grid&&(t=!1),t},getZeroBaseline:function(e){return{verticalZero:this.getZeroBaselineVertical(e),horizontalZero:this.getZeroBaselineHorizontal(e)}},getZeroBaselineVertical:function(e){return s.a.get(e,"axis.x.zeroBaseline",!0)},getZeroBaselineHorizontal:function(e){return s.a.get(e,"axis.y.zeroBaseline",!0)},assignAxisInverse:function(e,t,a){var i=["y","y2"].indexOf(a)+1;s.a.set(e,"axis[".concat(i,"].invert"),s.a.get(t,"axis.".concat(a,".invert"),!1))},assignTrendline:function(e,t){var a=s.a.merge({text:this.themeStyleColor.text},this.themeStyleColor.chart||{}),i=s.a.get(a,"text","#464646");s.a.set(e,"categories.trendline.enabled",s.a.get(t,"trendline.enabled",!1)),s.a.set(e,"categories.trendline.color",s.a.get(t,"trendline.color",i))},setupChartOptionsStyle:function(){var e=this,t=s.a.get(this,"custom.textColor"),a=this.chartOptions,i=s.a.merge({},this.themeFont.common||{},this.themeFont.label||{}),n=s.a.merge({},this.themeFont.common||{},this.themeFont.legend||{}),o=s.a.merge({text:this.themeStyleColor.text},this.themeStyleColor.chart||{});t&&(o.text=t),a.style.grid.color=Object(c.gridColor)(this.custom,{charts:this.charts,color:this.themeStyleColor}),a.style.grid.opacity=s.a.get(this,"custom.axis.alpha",s.a.get(this,"charts.grid.alpha",.5)),s.a.set(a,"style.graph.item.outline.color",t||o.text),s.a.set(a,"style.graph.item.outline.width","1px"),["x","y","y2"].forEach(function(t){a.style.axis[t].tick["font-family"]=s.a.get(e,"custom.labels.axis.".concat(t,".tick.font-family"),i.fontFamily),a.style.axis[t].tick["font-size"]=e.addPx(i.fontSize),a.style.axis[t].tick["font-weight"]=i.fontWeight,a.style.axis[t].tick["font-style"]=i.fontStyle,a.style.axis[t].tick.color=o.text,a.style.axis[t].title["font-family"]=s.a.get(e,"custom.labels.axis.".concat(t,".title.font-family"),i.fontFamily),a.style.axis[t].title.color=o.text}),["name","value"].forEach(function(t){a.style.graph.item[t]["font-family"]=s.a.get(e,"custom.labels.graph.item.value.font-family",i.fontFamily),a.style.graph.item[t]["font-size"]=e.addPx(i.fontSize),a.style.graph.item[t]["font-weight"]=i.fontWeight,a.style.graph.item[t]["font-style"]=i.fontStyle,"name"===t&&(a.style.graph.item[t].color=o.text)}),s.a.has(a.style,"graph.item.value.color.contrast")&&s.a.set(a.style,"graph.item.value.color.contrast.background",this.getChartBackgroundColor()),s.a.merge(a.style.sheetSwitch,s.a.get(this,"charts.sheetSwitch.style",{})),a.style.sheetSwitch.tab["font-family"]=s.a.get(this,"custom.labels.sheetSwitch.tab.font-family")||s.a.get(this,"charts.sheetSwitch.style.tab.font-family",i.fontFamily),a.style.sheetSwitch.radio["font-family"]=a.style.sheetSwitch.tab["font-family"];var l={};l.text=s.a.pick(a.style.sheetSwitch.tab,["font-family","font-size","font-weight"]);var h=s.a.get(this,"charts.sheetSwitch.style.tab.colors.tab.background");h&&s.a.set(l,"colors.background",h);var u=s.a.get(this,"charts.sheetSwitch.style.tab.color");if(u&&s.a.set(l,"colors.foreground",u),t){var f=a.style.sheetSwitch.tab;f.color=t,f.colors.dropdown.selectIcon=t,f.colors.dropdown.leftSwitcherIcon=t,f.colors.dropdown.rightSwitcherIcon=t}s.a.merge(a.style.hint,l),a.style.legend["font-family"]=s.a.get(this,"custom.labels.legend.font-family",n.fontFamily),a.style.legend["font-size"]=this.addPx(n.fontSize),a.style.legend["font-weight"]=n.fontWeight,a.style.legend["font-style"]=n.fontStyle,s.a.merge(a.style.legend.color,s.a.get(this,"charts.legend.color",{}));var d=s.a.get(this,"custom.labels.legend.color");if(!d&&t&&(d=t),d){var p=Object(r.rgb)(d);p.opacity=.7,a.style.legend.color.label={active:d,hover:p.toString(),inactive:d}}a.style.fontFamily=s.a.get(this,"custom.fontFamily")},setupChartOptionsCustomStyle:function(){this.assignChartOptionsCustomStyle(["axis.x.tick","axis.y.tick","axis.y2.tick","axis.x.title","axis.y.title","axis.y2.title","graph.item.name","graph.item.value","legend","sheetSwitch.tab","tooltip.text","tooltip.value","regionNames"])},assignChartOptionsCustomStyle:function(e){var t=this.chart,a=this.custom,i=this.chartOptions,n=Object(c.defaultColorMethod)(t),r=["font-size","font-style","font-weight","color"],o=this.getChartBackgroundColor(),l=t.getTypeMod(),h=[x.PICTORIAL_SIZE,x.PICTORIAL_BAR];e.forEach(function(e){s.a.get(a,"labels.".concat(e))&&r.forEach(function(t){var r=s.a.get(a,"labels.".concat(e,".").concat(t));if("graph.item.value"===e&&"color"===t&&(!r||"string"==typeof r)){if(-1!==h.indexOf(l))return;return x.TREEMAP===l?void(r&&"string"==typeof r&&s.a.set(i.style,"".concat(e,".").concat(t),r)):void s.a.set(i.style,"".concat(e,".").concat(t),s.a.merge({contrast:{background:o}},Object(c.defaultColorValue)(r,n)))}if(r&&("legend"!==e||"color"!==t)){var u="color"===t&&"graph.item.value"===e&&"object"===k(r)?s.a.merge({contrast:{background:o}},r):s.a.cloneDeep(r);s.a.set(i.style,"".concat(e,".").concat(t),u)}})})},setupChartOptionsDimensions:function(){var e=this.custom,t=this.chartOptions;s.a.get(e,"height")?t.height=parseInt(e.height,10):t.height=this.defaultHeight},getChartBackgroundColor:function(){var e=s.a.get(this.themeStyleColor,"chart.bg","transparent");return"transparent"===e&&"transparent"===(e=s.a.get(this.themeStyleColor,"bg","transparent"))&&(e="#ffffff"),e},createInstance:function(){var t,a=(t=regeneratorRuntime.mark(function t(){var a,i,n,r,c,h=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=function(){a?(delete r.legendData,r.render()):Object(o.addRenderQueue)(r)},a=!1,i=this.chartOptions,this.cleanup(),n=this.getChartInstance(),this.chartOptions.height||(this.chartOptions.height=N(this.chart.getTypeMod())),(r=s.a.get(n,"instance"))?(a=!0,this.instance=r,r.mergeOptions(i)):(r=new this.instanceClass(i),this.instance=r),s.a.has(this.custom,"defaultTab")&&(r.sheetIndex=this.custom.defaultTab),l.default.create({chartType:I(this),chart:r,decimalSeparator:this.getDecimalSeparator(),transpose:this.transposeImport(),useAllColumns:this.custom.useAllColumns,disableColumnSheets:this.disableColumnSheets,editable:this.editable}).import(this.data),r.applySheetOptions(r.options.sheetOptions),p.default.subscribe(this),void 0!==this.sheetIndex&&(r.sheetIndex=this.sheetIndex,s.a.set(r,"options.sheetSwitch.enabled",!1)),r.loaded=e.Deferred(),r.events.on("endAnimation",function(){r.loaded.resolve(),r.events.on("endAnimation",null),h.chart.getTypeMod()===x.MAP&&!1!==s.a.get(r,"options.mobileInteractivityHint")&&(h.interactivityHintEnabled=!0,r.interactivityHintText="Use two fingers to zoom or pinch map"),h.observer&&h.interactivityHintEnabled&&-1===D.indexOf(h.viewMode)&&h.observer.add(r.root.node(),function(e){h.observer.getSmallerObjectVisibilityRatio(e)>.5?h.scheduleInteractivityHint(r):h.cancelInteractivityHint()})}),r.events.on("downloadData",function(){var e=r.sheetIndex,t=h.chart.get("data"),a=t[e]?e:0,i={data:t[a],title:h.chart.get("sheetnames")[a]||"data",firstCellContainsData:T.includes(h.chart.getTypeMod())};m.default.downloadData(i)}),this.chart.getTypeMod()===x.MAP&&r.events.on("storePosition",function(){var e=r.map;e.resetZoom&&e.positionChanges&&delete e.resetZoom;var t=e.applyToAllSheets,a=[];if(t)for(var i=0,n=r.options.sheets.length;i<n;i++)a.push(i);else a.push(r.sheetIndex);var o=e.getBounds(),c={view:{bounds:[[o.getNorthWest().lat,o.getNorthWest().lng],[o.getSouthEast().lat,o.getSouthEast().lng]]}};e.resetZoom&&(c.view=null,delete e.resetZoom);var l=h.chart;(a.forEach(function(e){(r.options.sheetOptions[e]=s.a.merge({},r.options.sheetOptions[e],{view:c.view}),r.options.sheets[e]=s.a.merge({},r.options.sheets[e],{view:c.view}),Object(g.default)({chart:l,sheetIndex:e}).setCustom(c),t)||Object(b.buildXHR)({sheetIndex:e,chart:l}).setCustom(c).send()}),t)&&Object(b.buildXHR)({chart:l,applyToAllSheets:"view"}).setCustom(c).send();Object(d.default)(l)}),r.events.on("interaction",function(e){!h.freeLayout&&"preview"===h.viewMode&&"link"===e.location&&"click"===e.type&&s.a.get(e,"params.value")&&(window.open(e.params.value).opener=null);var t=h.id;"number"==typeof h.id&&(t="c_".concat(h.id)),Object(y.engagementEvent)(t,e.location,e.type),h.interactedWith=!0}),"embed"===this.viewMode||"web"===this.viewMode?this.delayedRender=requestAnimationFrame(c):this.delayedRender=s.a.delay(c,this.delayVisualInitialization),t.abrupt("return",this);case 20:case"end":return t.stop()}},t,this)}),function(){var e=this,a=arguments;return new Promise(function(i,n){var s=t.apply(e,a);function r(e){S(s,i,n,r,o,"next",e)}function o(e){S(s,i,n,r,o,"throw",e)}r(void 0)})});return function(){return a.apply(this,arguments)}}(),resize:function(e,t){var a=this.instance;a.options.width=e,t&&(a.options.height=t),Object(o.addRenderQueue)(a)},getDecimalSeparator:function(){var e=-1!==E.indexOf(this.custom.decimalSeparator),t=E[0],a=[];e&&(t=this.custom.decimalSeparator);var i=this.infographic&&this.infographic.get("properties")&&this.infographic.get("properties").decimal_separator;return!e&&i&&(t=i),s.a.has(this,"custom.dataInputFormat.decimalSeparator")&&(t=s.a.get(this,"custom.dataInputFormat.decimalSeparator")),a.push(t),this.sheetSettings&&(a=a.concat(this.sheetSettings.map(function(e){return e&&e.decimalSeparator||null}))),a},transposeImport:function(){return this.custom.switchRowsColumns},updateData:function(e){var t=this.instance;t&&(l.default.create({chartType:I(this),chart:t,decimalSeparator:this.getDecimalSeparator(),transpose:this.transposeImport()}).import(e),t.applySheetOptions(t.options.sheetOptions),t.render())},assignCategoryLabelLayout:function(e,t){"tilted"===t.categoryLayout&&(e.layout="tilted")},assignNumberFormatValues:function(e){var t=this,a=e.sheetOptions,i=e.custom,n=e.axis,r={x:0,y:1,y2:2};n.forEach(function(e){var n=e.id,o=e.path,c=o?s.a.get(i,o,{}):i,l=a.axis[r[n]];s.a.has(l,"format")||s.a.set(l,"format",{});var u=l.format;if(C(u,c),s.a.has(t,"custom.dataInputFormat.decimalSeparator")){var f=s.a.get(t,"custom.dataInputFormat.decimalSeparator");s.a.set(u,"numberParser",new h.default("firstNumber",f))}var d=["useSIPrefixes"];s.a.get(i,"axis.".concat(n,".affix"),!0)&&d.push("prefix","suffix"),d.forEach(function(e){var t=s.a.get(c,e);void 0!==t&&s.a.set(u,e,t)})})},assignNumberFormatLabels:function(e){var t=this,a=e.sheetOptions,i=e.custom,n=e.affixes,r={label:{libraryTargetPath:"labels.format",customAffixPath:"labels.graph.item.format.affix"},x:{libraryTargetPath:"tooltip.format.x",customAffixPath:"labels.tooltip.format.x.affix"},y:{libraryTargetPath:"tooltip.format.y",customAffixPath:"labels.tooltip.format.y.affix"},y2:{libraryTargetPath:"tooltip.format.y2",customAffixPath:"labels.tooltip.format.y2.affix"}};(void 0===n?[]:n).forEach(function(e){var n=e.id,o=e.path,c=e.ignoreCheck,l=e.defaultValue,u=r[n],f=u.libraryTargetPath,d=u.customAffixPath,p=o?s.a.get(i,o,{}):i,g=s.a.pick(p,"prefix","suffix");if(C(g,p),s.a.has(t,"custom.dataInputFormat.decimalSeparator")){var m=s.a.get(t,"custom.dataInputFormat.decimalSeparator");s.a.set(g,"numberParser",new h.default("firstNumber",m))}c||s.a.get(i,d,l)||(s.a.unset(g,"prefix"),s.a.unset(g,"suffix")),s.a.set(a,f,g)})},assignAxisTicks:function(e,t){var a=e.axis,i=["x","y","y2"];a.forEach(function(e,a){e.ticks=s.a.get(t,"labels.axis.".concat(i[a],".tick.enabled"),!0)})},assignAxisTickInterval:function(e,t){var a=e.axis,i=["x","y","y2"];a.forEach(function(e,a){var n=s.a.get(t,"axis.".concat(i[a],".ticks"));void 0!==n&&(e.tickInterval=n)})},scheduleInteractivityHint:function(e){var t=this;this.interactedWith||this.interactivityHintDelay||(this.interactivityHintDelay=setTimeout(function(){t.interactedWith||(e.interactionHint(),t.interactedWith=!0,t.interactivityHintDelay=null)},3e3))},cancelInteractivityHint:function(){this.interactivityHintDelay&&(clearTimeout(this.interactivityHintDelay),this.interactivityHintDelay=null)},getChartInstance:function(){return O.default.getEntity(this.id)},cleanup:function(){var e,t=this.id,a=this.getChartInstance();a&&(e=a.instance),this.loadingShapes&&(this.loadingShapes.abort(),this.loadingShapes=void 0),e&&(this.observer&&this.observer.remove(e.container.node()),this.cleanUpSheetPlayer(),this.instanceClass.getClassName()!==e.getClassName()&&w(t,e.container.node()))},remove:function(){var e,t=this.id,a=this.getChartInstance();a&&(e=a.instance),e&&(this.cleanUpSheetPlayer(),w(t,e.container.node()))},cleanUpSheetPlayer:function(){var e=this.getChartInstance(),t=s.a.get(e,"instance.sheetPlayer");t&&t.remove()}}}.call(this,a("+hRF"))},JnWj:function(e,t,a){"use strict";a.r(t);var i={firstNumber:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".",a=1;function i(e){return e<0?"-":""}if("string"==typeof(e=n(e))){var s=[],r=e.search(/\d/),o=r-1,c=e.indexOf(t);if(-1===c&&(c=e.length),c<r){if(e[o]===t){var l=e.slice(o,e.length).split(/(\d+)/);return l[0]===t&&l[1]&&s.push("0.".concat(l[1])),"-"===e[c-1]&&(a=-1),"".concat(i(a)).concat(n(s.join("")))}c=e.length}"-"===e[o]&&(a=-1);for(var h,u=e.slice(r,c),f=1,d=/^[\\., ]$/,p=u.split(/(\d+)/),g=p.length;f<g;f++){var m=p[f];if(/\d/.test(m))if(1===f){if(s.push(m),m.length>3)break}else{if(3!==m.length)break;s.push(m)}else{if(!d.test(m))break;if(h||(h=m),h!==m)break}}if(s.join(" ").length===u.length){var v=e.slice(c,e.length).split(/(\d+)/);v[0]===t&&v[1]&&s.push("."+v[1])}e=n(s.join(""))}return"".concat(i(a)).concat(e)},legacy:function(e){var t="";return"string"==typeof e&&(t="-"===e[0]?e[0]:"",-1!==e.indexOf(",")&&(e=e.replace(/,/g,".")),e=(e=e.replace(/\.(?![^.]+$)/g,"")).replace(/[^0-9\.]/g,"")),""===e?"undefined":"".concat(t).concat(n(e))}};function n(e){if(""!==e)return e}t.default=function(e,t){return t=","===t?",":".",function(e,t){return function(a){return e(a,t)}}(i[e]||i.firstNumber,t)}},LU9w:function(e,t,a){"use strict";a.r(t),a.d(t,"ENGAGEMENT_EVENT",function(){return i}),a.d(t,"ENGAGEMENT_INSCREEN",function(){return n});var i="ENGAGEMENT_EVENT",n="ENGAGEMENT_INSCREEN"},Oq5T:function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return u});var i=a("LvDl"),n=a.n(i);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var r=/\[img\=((https?:)?\/\/[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,16}\b[-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)\]/g,o=/\[svg\=([^]*)\]/g,c=/\[([^\]]*)\]\((https?:\/\/[^\)]*)\)/gi,l=["background-color","color","font-size","font-style","font-weight","text-align","text-decoration","vertical-align"],h=function(e){if("link"===e.type){var t=function(e){return-1===e.indexOf("mailto:")?"_blank":"_self"}(e.href),a=n.a.escape(e.href),i=(e.value||"").replace(/\</g,"&lt;");return{href:a,value:i,target:t,text:i.toLowerCase()}}if(e.value||""===e.value){var s=e.value.toString().replace(/\</g,"&lt;");return{text:s.toLowerCase(),value:s}}for(var r,o=e=e.toString().replace(/\</g,"&lt;");null!==(r=c.exec(e));)r&&r[1]&&r[2]&&(e=e.replace(r[0],"<a href='".concat(r[2],"' target='_blank'>").concat(r[1],"</a>")),o=o.replace(r[0],r[1]));return c.lastIndex=0,{text:o.toLowerCase(),value:e}};function u(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i={value:"",className:t};if(null==e)return i;"object"===s(e)&&Object.keys(e).forEach(function(t){-1!==l.indexOf(t)&&(i[t]=e[t])});var c=n.a.get(e,"value",e);""!==c&&a&&"igc-table-header"!==t&&(i.shape=a,i.tooltip=c),r.lastIndex=0;var u=r.exec(c);if(u)i.img=u[1],i.tooltip="";else{o.lastIndex=0;var f=o.exec(c);f&&(i.shape=f[1],i.tooltip="")}return n.a.merge(i,h(e))}},PZzD:function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return o});var i=a("LvDl"),n=a.n(i),s=a("Z8Pq");function r(e,t){return n.a.get(e,"sheetOptions[".concat(t,"].series[0].parseFormat.x"))}function o(e){var t=e.options,a=e.emptySheet,i=Object(s.createExtractCell)(t);return{default:Object(s.createImportFn)(function(o,c){var l=n.a.merge({},a),h=o[0]||[],u=t.sheetnames&&t.sheetnames[c],f=function(e){return e};"number"===(r(t,c+1)||r(t,0))&&(f=e.createNumberParser(c+1));var d=n.a.merge({},l.series[0]);l.series=[d],d.data=[],d.rawData=[],d.links=[],l.categories.data||(l.categories.data=[]),l.categories.title=Object(s.replaceBlank)(u||h[0]),o.forEach(function(e,t){if(0!==t){var a,n=[];e.forEach(function(e){var t=i(e);t.link&&!a&&(a=t.link),n.push(t.value)}),l.categories.data.push(n[0]);var s={x:f(n[1]),x2:f(n[2]),label:n[3]};d.data.push(s),d.rawData.push(s),d.links.push(a)}}),t.sheets.push(l)}),transposed:Object(s.createImportFn)(function(e,r){var o=n.a.merge({},a),c=n.a.merge({},o.series[0]);o.series=[c],c.data=[],c.rawData=[],c.links=[];var l=e[0]&&e[0].map(function(e){return Object(s.replaceBlank)(e,"",!0)})||[],h=n.a.get(t,"sheetnames[".concat(r,"]")),u=Object(s.getMaxColCount)(e);o.categories.data||(o.categories.data=[]),o.categories.title=h||Object(s.replaceBlank)(n.a.get(l,"[0]"),"",!0);for(var f=1;f<u;f++){for(var d=void 0,p=[],g=0;g<4;g++){var m=n.a.get(e,"[".concat(g,"][").concat(f,"]")),v=i(m);v.link&&!d&&(d=v.link),p.push(v.value)}o.categories.data.push(p[0]);var b={x:p[1],x2:p[2],label:p[3]};c.data.push(b),c.rawData.push(b),c.links.push(d)}t.sheets.push(o)})}}},PiB6:function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return r});var i=a("LvDl"),n=a.n(i),s=a("Z8Pq");function r(e){var t=e.options,a=e.emptySheet,i=e.createNumberParser,r=Object(s.createExtractCell)(t);return{default:Object(s.createImportFn)(function(o,c){var l=n.a.merge({},a),h=o[0]||[],u=n.a.get(t,"sheetnames[".concat(c,"]")),f=i.call(e,c+1),d=n.a.merge({},l.series[0]);l.series=[d],d.data=[],d.rawData=[],d.links=[],l.categories.data=h.slice(1,5),l.categories.title=Object(s.replaceBlank)(u||h[0]);for(var p=function(e){var t=o[e];if(t.length<5)return"continue";var a=void 0,i=[];t.forEach(function(e){var t=r(e);t.link&&!a&&(a=t.link),i.push(t.value)});var n=f(i[1]),s=f(i[2]),c=f(i[3]),l=f(i[4]);if(isNaN(n)||isNaN(s)||isNaN(c)||isNaN(l))return"continue";var h=[i[0],n,s,c,l];d.data.push(h),d.rawData.push(i.slice(0)),d.links.push(a)},g=1;g<o.length;g++)p(g);t.sheets.push(l)}),transposed:Object(s.createImportFn)(function(o,c){var l=n.a.merge({},a),h=i.call(e,c+1),u=n.a.merge({},l.series[0]);l.series=[u],u.data=[],u.rawData=[],u.links=[];var f=o[0]&&o[0].map(function(e){return Object(s.replaceBlank)(e,"",!0)})||[],d=n.a.get(t,"sheetnames[".concat(c,"]")),p=Object(s.getMaxColCount)(o);l.categories.title=d||Object(s.replaceBlank)(n.a.get(f,"[0]"),"",!0),l.categories.data=[];for(var g=1;g<5;g++){var m=n.a.get(o,"[".concat(g,"][0]")),v=r(m);l.categories.data.push(v.value)}for(var b=1;b<p;b++){for(var y=void 0,O=[],x=0;x<5;x++){var S=n.a.get(o,"[".concat(x,"][").concat(b,"]")),k=r(S);k.link&&!y&&(y=k.link),O.push(k.value)}var w=h(O[1]),I=h(O[2]),C=h(O[3]),E=h(O[4]);if(!(isNaN(w)||isNaN(I)||isNaN(C)||isNaN(E))){var j=[O[0],w,I,C,E];u.data.push(j),u.rawData.push(j),u.links.push(y)}}t.sheets.push(l)})}}},S99L:function(e,t,a){"use strict";a.r(t);var i=a("LvDl"),n=a.n(i),s=["=","@","+"],r={convertDataToCSV:function(e,t){var a=/\"/g,i="\ufeff";return e.forEach(function(e,r){i+=e.map(function(e,i){return e&&(t||r||i)||(e=""),n.a.has(e,"value")&&(e=e.value),e=e.toString().replace(a,'""').replace("\n",""),-1!==s.indexOf(e[0])&&(e="'".concat(e)),'"'.concat(e,'"')})+"\n"}),i},forceDownloadOfContent:function(e,t){var a=new Blob([e],{type:"octet/stream"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(a,t);else{var i=window.URL.createObjectURL(a),n=document.createElement("a");document.body.appendChild(n),n.style.display="none",n.href=i,n.download=t,n.click(),window.URL.revokeObjectURL(i),n.remove()}},downloadData:function(e){var t=e.data,a=e.title,i=e.firstCellContainsData,n="".concat(a,".csv"),s=r.convertDataToCSV(t,i);"undefined"!=typeof ga&&ga("send","event","Download chart data"),r.forceDownloadOfContent(s,n)}};t.default=r},SdvQ:function(e,t,a){"use strict";a.r(t),a.d(t,"engagementEvent",function(){return s}),a.d(t,"engagementInscreen",function(){return r});var i=a("Zcty"),n=a("LU9w"),s=function(e,t,a){i.default.dispatch({type:n.ENGAGEMENT_EVENT,objectId:e,eventType:t,action:a})},r=function(){i.default.dispatch({type:n.ENGAGEMENT_INSCREEN})}},Z8Pq:function(e,t,a){"use strict";a.r(t),a.d(t,"isBlank",function(){return s}),a.d(t,"replaceBlank",function(){return r}),a.d(t,"getMaxColCount",function(){return o}),a.d(t,"fillSheets",function(){return c}),a.d(t,"spreadSheets",function(){return h}),a.d(t,"createExtractCell",function(){return u}),a.d(t,"createImportFn",function(){return f}),a.d(t,"getRowValuesAndLink",function(){return d}),a.d(t,"categoryHelper",function(){return p}),a.d(t,"seriesHelper",function(){return g}),a.d(t,"isSeriesDataValid",function(){return m}),a.d(t,"cleanSheetSeries",function(){return v}),a.d(t,"isValidColor",function(){return b}),a.d(t,"validDataMaxLimit",function(){return y}),a.d(t,"limitSheetData",function(){return O});var i=a("LvDl"),n=a.n(i);function s(e){return"number"==typeof e&&isNaN(e)||null==e||""===e}function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return s(e)?t:a&&e.value?e.value:e}function o(e){return n.a.reduce(e,function(e,t){return Math.max(e,t.length)},0)}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e.forEach(function(e){e.length||(e=[[]]);var i=a;e.forEach(function(e){e&&e.length>i&&(i=e.length)});for(var s=Math.max(e.length,t),r=0;r<s;r++){e[r]||(e[r]=[]);for(var o=0;o<i;o++)n.a.isUndefined(e[r][o])&&(e[r][o]="")}}),e}function l(e){var t=[];return e.forEach(function(e,a){e.length<2&&0===a&&(e=[e[0]||"",""]),e.forEach(function(a,i){if(i>0){var n=i-1;(t[n]?t[n]:t[n]=[]).push([e[0],a])}})}),t}function h(e,t){if(e.length<2)return l(e[0]);if(t){var a=[];return e.forEach(function(e){l(e).forEach(function(e){a.push(e)})}),a}return e}function u(e){var t=e.custom,a="edit"!==n.a.get(t,"viewMode");return function(e){var t={};return n.a.isPlainObject(e)?(n.a.has(e,"value")&&(t.value=e.value),a&&"link"===n.a.get(e,"type")&&(t.link=e.href),t):(t.value=e,t)}}function f(e){return function(t){t.forEach(e)}}function d(e,t){var a={row:[]};return e.forEach(function(e,i){var n=t(e);n.link&&(a.link=n.link),a.row[i]=n.value}),a}function p(e){return function(t){var a=e.categories.data,i=a.indexOf(t);return-1===i&&(i=a.length,a.push(t)),i}}function g(e,t){return function(a,i){var s=e.series[a];return s||((s=e.series[a]=n.a.merge({},t)).index=void 0!==i?i:a,s.data=s.data||[],s.rawData=s.rawData||[],s.links=s.links||[]),s}}function m(e){return 0!==e.length&&n.a.some(e,function(e){return!isNaN(e)})}function v(e){var t=[];e.forEach(function(e,a){m(e.data)||t.push(a)}),function e(t,a){t.length&&(a.splice(t[0],1),t.shift(),function(e){e.forEach(function(t,a){e[a]=t-1})}(t),e(t,a))}(t,e)}function b(e){if(!e||4!==e.length&&7!==e.length)return!1;return!!e.match(/^\#[0-9a-f]{6}$|^\#[0-9a-f]{3}$/gi)}function y(e,t){var a=0;return e.forEach(function(e){for(var i=e.data.length-1,n=i;n>=0;n--){var s=e.data[n];if(i=n,t(s))break}a=Math.max(a,i)}),a}function O(e,t){e.series.forEach(function(e){e.data.splice(t),e.rawData.splice(t),e.links.splice(t)}),e.categories.data.splice(t)}},ZBKM:function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return c});var i=a("Pp7T"),n=a.n(i),s=a("JPcv"),r=a("Zcty"),o=a("hl5+");function c(e,t,a){n()(s.Map.isMap(t),"External chart data should be immutable"),r.default.dispatch({type:o.EDITOR_SET_CHART_EXTERNAL_DATA,id:e,data:t,model:a})}},ibon:function(e,t,a){"use strict";a.r(t);var i=a("LvDl"),n=a.n(i),s=a("JnWj"),r=a("m6Yx"),o=a("PZzD"),c=a("PiB6"),l=a("474q"),h=a("Z8Pq"),u=a("0Qba"),f=a("Oq5T"),d=a("pWQL");function p(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var g=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.emptySheet=t.chart.emptySheetData(),this.options=t.chart.options,this.transpose=t.transpose,this.useAllColumns=t.useAllColumns,this.decimalSeparators=[].concat(t.decimalSeparator),this.disableColumnSheets=t.disableColumnSheets,this.factoryInstance=t.factoryInstance,this.chartType=t.chartType}var t,a,i;return t=e,(a=[{key:"createNumberParser",value:function(e){var t=this.decimalSeparators,a=t[e]||t[0]||".",i=".,"===a?"legacy":"firstNumber";return new s.default(i,a)}},{key:"findImportFn",value:function(t){for(var a in e.IMPORT_TYPES){var i=e.IMPORT_TYPES[a];if(-1!==i.types.indexOf(t))return this.transpose&&i.fnTranspose?i.fnTranspose:i.fn}}},{key:"import",value:function(e){if(e&&0!==e.length){var t=JSON.parse(JSON.stringify(e)),a=this.findImportFn(this.chartType);a&&(this.options.sheets=[],a.call(this,t))}}},{key:"singleSheetItem",value:function(e,t){var a=this.emptySheet,i=e.length,s=this.createNumberParser(t+1),r=Object(h.createExtractCell)(this.options);if(0!==i)for(var o=this.useAllColumns?Object(h.getMaxColCount)(e):2,c=1;c<o;c++){var l=n.a.merge({},a),u=l.series[0],f=l.categories.data=[];l.categories.title=Object(h.replaceBlank)(e[0][c],"",!0),u.data=[],u.rawData=[],u.links=[];for(var d=1;d<i;d++){var p=e[d],g="".concat(Object(h.replaceBlank)(p[0],"",!0)),m=r(p[c]);f.push(g),u.data.push(Number(s(m.value))),u.rawData.push(m.value),u.links.push(m.link)}Object(h.isSeriesDataValid)(u.data)&&this.options.sheets.push(l)}}},{key:"singleSheetItemTranspose",value:function(e,t){var a=this.emptySheet,i=e.length,s=Object(h.getMaxColCount)(e),r=this.createNumberParser(t+1);if(!(i<2))for(var o=this.useAllColumns?i:2,c=1;c<o;c++){var l=n.a.merge({},a),u=l.series[0],f=e[0].map(function(e){return Object(h.replaceBlank)(e,"",!0)}).slice(1);l.categories.title=Object(h.replaceBlank)(e[c][0]),u.data=[],u.rawData=[];var d=e[c];if(0!==d.length){for(var p=1;p<s;p++){var g=d[p];u.data.push(Number(r(g))),u.rawData.push(g)}l.categories.data=f,Object(h.isSeriesDataValid)(u.data)&&this.options.sheets.push(l)}}}},{key:"singleSheetItemOnly",value:function(e){for(var t=this.options,a=[],i=[],s=e[0]||[],r=e.length,o=this.disableColumnSheets?2:Object(h.getMaxColCount)(e),c=[],l=Object(h.createExtractCell)(t),u=1;u<r;u++){var f=e[u];a.push("".concat(Object(h.replaceBlank)(f[0],"",!0)));for(var d=1;d<o;d++){var p=d-1,g=l(f[d]),m=c[p],v=i[p];v||((v=i[p]=n.a.merge({},this.emptySheet)).categories.data=[],v.categories.title=Object(h.replaceBlank)(s[d],"",!0),v.series[0].index=p,v.series[0].data=[],v.series[0].rawData=[],v.series[0].links=[],m=c[p]=this.createNumberParser(d)),v.series[0].data.push(Number(m(g.value))),v.series[0].rawData.push(g.value),v.series[0].links.push(g.link)}}i.forEach(function(e){e.categories.data=a.slice(0)}),t.sheets=i.filter(function(e){return Object(h.isSeriesDataValid)(e.series[0].data)})}},{key:"singleSheetItemOnlyTranspose",value:function(e){for(var t=this.options,a=(e[0]&&e[0].map(function(e){return Object(h.replaceBlank)(e,"",!0)})||[]).slice(1),i=[],s=this.disableColumnSheets?2:e.length,r=Object(h.getMaxColCount)(e),o=[],c=Object(h.createExtractCell)(t),l=1;l<s;l++){var u=l-1,f=e[l],d=o[u],p=i[u];if(0!==f.length){p||((p=i[u]=n.a.merge({},this.emptySheet)).categories.title=Object(h.replaceBlank)(f[0],"",!0),p.series[0].data=[],p.series[0].rawData=[],d=o[u]=this.createNumberParser(l),p.series[0].links=[]);for(var g=1;g<r;g++){var m=c(f[g]);p.series[0].data.push(Number(d(m.value))),p.series[0].rawData.push(m.value),p.series[0].links.push(m.link)}p.categories.data=a}}t.sheets=i.filter(function(e){return Object(h.isSeriesDataValid)(e.series[0].data)})}},{key:"multiSheetItemTranspose",value:function(e,t){var a=this.options,i=this.emptySheet,s=n.a.merge({},i),r=s.series.pop(),o=e.length,c=a.sheetnames&&a.sheetnames[t],l=this.createNumberParser(t+1),u=Object(h.createExtractCell)(a),f=0;if(0!==o){var d=e[0].map(function(e){return Object(h.replaceBlank)(e,"",!0)});s.categories.title=Object(h.replaceBlank)(c||d[0]),s.categories.data=d.slice(1);for(var p=1;p<o;p++){var g=e[p],m=g.length;if(m){var v=u(g[0]),b=n.a.merge({},r,{title:"".concat(Object(h.replaceBlank)(v.value,"",!0)),index:p-1,data:[],rawData:[],links:[],titleLink:v.link});f=Math.max(f,m-1),b.titleLink=v.link;for(var y=1;y<m;y++){var O=u(g[y]);b.data.push(Number(l(O.value))),b.rawData.push(O.value),b.links.push(O.link)}Object(h.isSeriesDataValid)(b.data)&&s.series.push(b)}}for(var x=0;x<f;x++)s.categories.data[x]=Object(h.replaceBlank)(s.categories.data[x]);a.sheets.push(s)}else a.sheets.push(n.a.merge(s,{categories:{title:"",data:[]},series:[n.a.merge(r,{data:[],rawData:[]})]}))}},{key:"multiSheetItem",value:function(e,t){var a=this.options,i=n.a.merge({},this.emptySheet),s=i.series.pop(),r=e.length,o=a.sheetnames&&a.sheetnames[t],c=this.createNumberParser(t+1),l=Object(h.createExtractCell)(a);if(0!==r){var u=Object(h.getMaxColCount)(e),f=e[0].map(function(e){return Object(h.replaceBlank)(e,"")}),d=l(f.shift()).value,p=[],g=[];f.forEach(function(e,t){var a=l(e);p[t]=a.link,g[t]=a.value});var m=function(e,t){var a;(a=i.series[e]?i.series[e]:i.series[e]=n.a.merge({},s,{title:"".concat(Object(h.replaceBlank)(g[e])),data:[],index:e,rawData:[],links:[]})).links.push(t.link),a.data.push(Number(c(t.value))),a.rawData.push(t.value),a.titleLink=p[e]};i.categories.title=Object(h.replaceBlank)(o||d),i.categories.data=[];for(var v=1;v<r;v++){var b=e[v],y=b.length,O=Object(h.replaceBlank)(b[0],"");if(n.a.has(O,"value")&&(O=O.value),y){i.categories.data.push(O);for(var x=1;x<u;x++)m(x-1,l(b[x]))}}Object(h.cleanSheetSeries)(i.series),a.sheets.push(i)}else a.sheets.push(n.a.merge(i,{categories:{title:"",data:[]},series:[n.a.merge(s,{data:[],rawData:[]})]}))}},{key:"doubleAxisSheetItem",value:function(e,t){var a=n.a.merge({},this.emptySheet),i=this.options,s=i.sheetnames&&i.sheetnames[t],r=this.createNumberParser(t+1),o=Object(h.createExtractCell)(i);a.series[0].data||(a.series[0].data=[]),a.series[0].rawData||(a.series[0].rawData=[]),a.series[0].links||(a.series[0].links=[]),a.series[1].links||(a.series[1].links=[]),a.series[1].data||(a.series[1].data=[]),a.series[1].rawData||(a.series[1].rawData=[]),a.categories.data||(a.categories.data=[]),a.series[1].links||(a.series[1].links=[]),e.forEach(function(e,t){if(0===t)a.categories.title=Object(h.replaceBlank)(s||e[0]),a.axis[1].title=Object(h.replaceBlank)(e[1],"",!0),a.axis[2].title=Object(h.replaceBlank)(e[2],"",!0),a.axis[1].ticks=a.axis[2].ticks=!0,a.series[0].title=Object(h.replaceBlank)(e[1],"",!0),a.series[1].title=Object(h.replaceBlank)(e[2],"",!0);else{var i=Object(h.replaceBlank)(e[0],"",!0);if(Object(h.isBlank)(i))return;for(var n=[],c=1;c<3;c++){var l=o(e[c]);l.link&&(n[c-1]=l.link),e[c]=l.value}a.categories.data.push("".concat(i)),a.series[0].data.push(Number(r(e[1]))),a.series[0].rawData.push(e[1]),a.series[1].data.push(Number(r(e[2]))),a.series[1].rawData.push(e[2]),a.series[0].index=0,a.series[1].index=1,a.series[0].links.push(n[0]),a.series[1].links.push(n[1])}}),Object(h.cleanSheetSeries)(a.series),this.options.sheets.push(a)}},{key:"doubleAxisSheetItemTranspose",value:function(e,t){var a=n.a.merge({},this.emptySheet),i=e[0]&&e[0].map(function(e){return Object(h.replaceBlank)(e,"",!0)})||[],s=Object(h.getMaxColCount)(e),r=this.options,o=r.sheetnames&&r.sheetnames[t],c=this.createNumberParser(t+1),l=Object(h.createExtractCell)(r);a.series[0].data||(a.series[0].data=[]),a.series[0].rawData||(a.series[0].rawData=[]),a.series[0].links||(a.series[0].links=[]),a.series[1].links||(a.series[1].links=[]),a.series[1].data||(a.series[1].data=[]),a.series[1].rawData||(a.series[1].rawData=[]),a.categories.data||(a.categories.data=[]),a.categories.data=i.slice(1),a.categories.title=Object(h.replaceBlank)(o||i[0]),a.axis[1].ticks=a.axis[2].ticks=!0;for(var u=0;u<2;u++){var f=e[u+1];a.axis[u+1].title=Object(h.replaceBlank)(f[0],"",!0),a.series[u].title=Object(h.replaceBlank)(f[0],"",!0),a.series[u].index=u;for(var d=1;d<s;d++){var p=l(f[d]);a.series[u].links.push(p.link),a.series[u].data.push(Number(c(p.value))),a.series[u].rawData.push(p.value)}}this.options.sheets.push(a)}},{key:"comboSheetItem",value:function(e,t){var a=n.a.merge({},this.emptySheet),i=this.options,s=n.a.merge({},a.series[0]),r=e[0]||[],o=i.sheetnames&&i.sheetnames[t],c=this.createNumberParser(t+1),l=Object(h.getMaxColCount)(e),u=Object(h.createExtractCell)(i);a.series=[],a.categories.data||(a.categories.data=[]);var f=Object(h.seriesHelper)(a,s);r&&(a.categories.title=Object(h.replaceBlank)(o||u(r[0]).value));var d=n.a.get(this.options,"sheetOptions[".concat(t+1,"].axis[2]"));d&&!0===d.ticks&&l<3&&(this.options.sheetOptions[t+1].series[0].axisIndex=1,this.options.sheetOptions[t+1].axis[2].ticks=!1),e.forEach(function(e,t){if(0!==t){a.categories.data.push(Object(h.replaceBlank)(u(e[0]).value));for(var i=1;i<l;i++){var n=u(e[i]),s=n.value,o=n.link,d=f(i-1);if(1===t&&!d.title&&r[i]){var p=u(r[i]),g=p.value,m=p.link;d.title=Object(h.replaceBlank)(g),d.titleLink=m}d.data.push(Number(c(s))),d.rawData.push(s),d.links.push(o)}}});var p=Object(h.validDataMaxLimit)(a.series,function(e){return!isNaN(e)});p=Math.max(p,Object(h.validDataMaxLimit)([a.categories],function(e){return!Object(h.isBlank)(e)}))+1,Object(h.limitSheetData)(a,p),Object(h.cleanSheetSeries)(a.series),this.options.sheets.push(a)}},{key:"FactsAndFiguresItem",value:function(e,t){var a=this.options,i=n.a.merge({},this.emptySheet),s=e.length,r=a.sheetnames&&a.sheetnames[t]||"Sheet ".concat(t+1),o=Object(h.createExtractCell)(a);0!==s?(i.categories.data=[],i.categories.title=Object(h.replaceBlank)(r),e.forEach(function(e){if(e.length){var t=u.default.shapes[e[2]];i.categories.data.push({color:Object(h.isValidColor)(e[4])&&e[4]||"",figure:o(e[0]).value,fact:o(e[1]||"").value,shape:t})}}),a.sheets.push(i)):a.sheets.push(n.a.merge(i,{categories:{title:"",data:[]}}))}},{key:"comboSheetItemTranspose",value:function(e,t){var a=n.a.merge({},this.emptySheet),i=n.a.merge({},a.series[0]),s=this.options,r=e[0]||[],o=s.sheetnames&&s.sheetnames[t],c=this.createNumberParser(t+1),l=Object(h.getMaxColCount)(e),u=Object(h.createExtractCell)(s);a.series=[],a.categories.data||(a.categories.data=r.slice(1).map(function(e){return u(e).value}));var f=Object(h.seriesHelper)(a,i);r&&(a.categories.title=Object(h.replaceBlank)(o||u(r[0]).value));var d=n.a.get(this.options,"sheetOptions[".concat(t+1,"].axis[2]"));d&&!0===d.ticks&&e.length<3&&(this.options.sheetOptions[t+1].series[0].axisIndex=1,this.options.sheetOptions[t+1].axis[2].ticks=!1),e.forEach(function(e,t){if(0!==t){var a=f(t-1),i=u(e[0]),n=i.value,s=i.link;a.title=Object(h.replaceBlank)(n),a.titleLink=s;for(var r=1;r<l;r++){var o=u(e[r]),d=o.value,p=o.link;a.data.push(Number(c(d))),a.rawData.push(d),a.links.push(p)}}});var p=Object(h.validDataMaxLimit)(a.series,function(e){return!isNaN(e)});p=Math.max(p,Object(h.validDataMaxLimit)([a.categories],function(e){return!Object(h.isBlank)(e)}))+1;var g=a.categories.data.length;if(g<p)for(var m=g;m<p;m++)n.a.isUndefined(a.categories.data[m])&&(a.categories.data[m]="");Object(h.limitSheetData)(a,p),Object(h.cleanSheetSeries)(a.series),this.options.sheets.push(a)}},{key:"scatterSheetItem",value:function(e,t){var a=n.a.merge({},this.emptySheet),i=this.options,s=n.a.merge({},a.series[0]),r=e[0]||[],o=i.sheetnames&&i.sheetnames[t],c=this.createNumberParser(t+1),l=Object(h.createExtractCell)(i),u=3===Object(h.getMaxColCount)(e);a.series=[],a.categories.data||(a.categories.data=[]);var f=Object(h.seriesHelper)(a,s),d=Object(h.categoryHelper)(a);r&&(a.categories.title=Object(h.replaceBlank)(o||r[0]),a.categories.valueLabel=Object(h.replaceBlank)(r[3],"",!0),a.axis[0].valueLabel=Object(h.replaceBlank)(r[1],"",!0),a.axis[1].valueLabel=Object(h.replaceBlank)(r[2],"",!0));var p=u?function(e,t){if(0!==t){var i=Object(h.getRowValuesAndLink)(e,l),n=i.row,s=i.link,r=n[1],o=n[2];if(!Object(h.isBlank)(r)&&!Object(h.isBlank)(o)){var u=n[0],d=a.categories.data.length;a.categories.data.push(u);var p=f(d,t-1),g=[Number(c(r)),Number(c(o))],m=[r,o];p.data.push(g),p.rawData.push(m),p.links.push(s)}}}:function(e,t){if(0!==t){var a=Object(h.getRowValuesAndLink)(e,l),i=a.row,n=a.link,s=i[1],r=i[2];if(!Object(h.isBlank)(s)&&!Object(h.isBlank)(r)){var o=i[4]?4:0,u=4===o?0:4,p=i[o],g=i[u],m=i[3],v=d(p),b=f(v,t-1),y=[Number(c(s)),Number(c(r))],O=[s,r];null!=m&&(O[2]=m,y[2]=Number(c(m))),null!=g&&(O[3]=g),b.data.push(y),b.rawData.push(O),b.links.push(n)}}};e.forEach(p),this.options.sheets.push(a)}},{key:"scatterSheetItemTranspose",value:function(e,t){var a=n.a.merge({},this.emptySheet),i=n.a.merge({},a.series[0]),s=Object(h.getMaxColCount)(e),r=this.options,o=e[0]&&e[0].map(function(e){return Object(h.replaceBlank)(e,"",!0)})||[],c=Object(h.categoryHelper)(a),l=Object(h.seriesHelper)(a,i),u=o,f=e[1],d=e[2],p=e[3],g=e[4],m=n.a.get(r,"sheetnames[".concat(t,"]")),v=this.createNumberParser(t+1),b=Object(h.createExtractCell)(r);a.series=[],a.categories.data||(a.categories.data=[]),a.categories.title=m||Object(h.replaceBlank)(n.a.get(o,"[0]"),"",!0),a.categories.valueLabel=Object(h.replaceBlank)(n.a.get(e,"[3][0]"),"",!0),a.axis[0].valueLabel=Object(h.replaceBlank)(n.a.get(e,"[1][0]"),"",!0),a.axis[1].valueLabel=Object(h.replaceBlank)(n.a.get(e,"[2][0]"),"",!0);for(var y=1;y<s;y++){var O=g?u:g,x=b((g||u)[y]),S=b(O,"[".concat(y,"]")).value,k=b(f[y]),w=b(d[y]),I=k.value,C=w.value,E=b(n.a.get(p,"[".concat(y,"]"))),j=E.value,T=l(c(x.value)),D=[Number(v(I)),Number(v(C))],N=[I,C],A=void 0;null!=j&&(N[2]=j,D[2]=Number(v(j))),null!=S&&(N[3]=S),[b(u),k,w,E,b(g)].forEach(function(e){e.link&&(A=e.link)}),T.data.push(D),T.rawData.push(N),T.links.push(A)}this.options.sheets.push(a)}},{key:"timerSheetItem",value:function(e){var t=e[0],a=!t[14]||"1"===t[14],i=this.options.sheets.push({value:new Date("".concat([t[2],t[3],t[1]].join("/")," ").concat(t.slice(4,7).join(":"))),valueString:t[0],units:t.slice(8,14),mode:t[7],categories:{title:!!a&&t[0]}});this.options.sheets[i-1].id=i.toString()}},{key:"sheetIterator",value:function(e,t){e.forEach(t,this)}},{key:"tableItem",value:function(e,t){var a=n.a.merge({},this.emptySheet),i=this.options,s=n.a.get(i,"sheetOptions[0]",{}),r=n.a.get(i,"sheetOptions[".concat(t+1,"]"),{}),o=s.hasHeaderRow,c=s.hasHeaderColumn,l=s.usePathInsteadOfText,d=n.a.get(r,"mergeCells",[]),p=n.a.get(r,"style.defaultPath")||n.a.get(s,"style.defaultPath"),g=l&&p,m=i.sheetnames&&i.sheetnames[t];a.series={data:[],shapes:u.default.shapes,sort:null};var v=0;e.forEach(function(e){v=Math.max(v,e.length)}),e.forEach(function(e,t){a.series.data[t]=[];for(var i=0;i<v;i++){var n=!t&&o||!i&&c?"igc-table-header":"igc-table-cell";a.series.data[t][i]=Object(f.default)(e[i],n,i&&g)}}),d.forEach(function(e){var t=e.col,i=e.rowspan,s=e.colspan,r=e.row,o=a.series.data;if(n.a.has(a,"series.data[".concat(r,"][").concat(t,"]"))){if(o[r][t].colspan=s,o[r][t].rowspan=i,s>1)for(var c=1;c<s;c++)o[r][t+c]&&(o[r][t+c].remove=!0);for(var l=r+1;l<r+i;l++)for(var h=0;h<s;h++)o[l]&&(o[l][t+h].remove=!0)}});var b=[];a.series.data.forEach(function(e){var t=[];e.forEach(function(e){e.remove||t.push(e)}),b.push(t)}),a.series.data=b,a.categories.title=Object(h.replaceBlank)(m)||n.a.get(b,"[0][0].value")||"Sheet "+t,o&&(a.series.headerRow=a.series.data.shift()),this.options.sheets.push(a)}},{key:"mapItem",value:function(e,t){var a=n.a.merge({},this.emptySheet),i=this.options,s=i.sheetnames&&i.sheetnames[t],r=Object(h.createExtractCell)(i),o=t+1,c=this.createNumberParser(o),l=/([^0-9]*)[0-9\.\ \,\']+([^0-9]*)/g,u=!!n.a.get(i,"sheetOptions[".concat(o,"].points"));a.series={data:{}},a.categories.title=Object(h.replaceBlank)(s)||"Sheet "+t;var f=n.a.get(i,"sheetOptions[".concat(o,"].xmin")),d=n.a.get(i,"sheetOptions[".concat(o,"].xmax")),p=n.a.get(i,"sheetOptions[0].xmin"),g=n.a.get(i,"sheetOptions[0].xmax"),m=[];if(void 0!==f&&void 0!==d&&""!==f&&""!==d)m=[f,d];else if(void 0!==p&&void 0!==g&&""!==g&&""!==p&&p!==g)m=[p,g];else{var v=!1;e.forEach(function(e){var t=Number(c(e[1]&&e[1].type?e[1].value:e[1]));!v&&Number.isFinite(t)?(m=[t,t],v=!0):Number.isFinite(t)&&(m[0]=Math.min(m[0],t),m[1]=Math.max(m[1],t))}),v||(m=[0,10]),m[1]===m[0]&&m[0]--,m[0]>0&&(m[0]=0)}a.limits=m;var b="",y="",O=/([\-]?[0-9]+[\.]?[0-9]*)[ \,]+([\-]?[0-9]+[\.]?[0-9]*)/;e.forEach(function(e,t){var i,s=n.a.map(e,function(e){var t=(e=r(e)).value;return e.link&&(i=e.link),t});s[0]=s[0]&&s[0].toString().trim()||"",s[2]=s[2]&&s[2].toString().trim()||"";var o=s[1]?s[1].toString():"";if(0===t){l.lastIndex=0;var h=l.exec(o);h&&(b=h[1],y=h[2])}else b&&0!==o.indexOf(b)&&(b=""),y&&o.indexOf(y)!==o.length-y.length&&(y="");var f=Number(c(s[1]||0)),d=m[1]!==m[0]?(f-m[0])/(m[1]-m[0]):1;!isFinite(d)||d<0?d=0:d>1&&(d=1);var p="",g={lat:null,lng:null};if(s[3]){O.lastIndex=0;var v=O.exec(s[3]);v&&v.length>2&&(g=[parseFloat(v[1])||0,parseFloat(v[2])||0])}s.length>5&&(p=s.slice(5).join("\n"));var x=u?"".concat(s[3]).concat(s[1]):s[0];a.series.data[x]={title:s[0],value:n.a.has(s[1],"value")?s[1].value:s[1],group:n.a.has(s[2],"value")?s[2].value:s[2],coordinates:g,label:(n.a.has(s[4],"value")?s[4].value:s[4])||s[0],text:p,link:i,valueNumber:f,relativeValue:d}}),"-"===b&&(b=""),a.categories.prefix=b,a.categories.suffix=y,this.options.sheets.push(a)}}])&&p(t.prototype,a),i&&p(t,i),e}();g.IMPORT_TYPES={singleSheet:{types:[d.BAR,d.BAR_PROGRESS,d.COLUMN,d.WATERFALL,d.PIE,d.PIE_IRREGULAR,d.DOUGHNUT,d.SEMI_CIRCLE,d.BAR_RADIAL,d.PICTORIAL_SIZE,d.PICTORIAL_GRID,d.PICTORIAL_BAR,d.TREEMAP,d.WORDCLOUD,d.PYRAMID,d.FUNNEL],fn:function(e){e.length>1?this.sheetIterator(e,function(e,t){this.singleSheetItem(e,t)}):this.singleSheetItemOnly(e[0])},fnTranspose:function(e){e.length>1?this.sheetIterator(e,function(e,t){this.singleSheetItemTranspose(e,t)}):this.singleSheetItemOnlyTranspose(e[0])}},multiSheet:{types:[d.LINE,d.DOT_PLOT,d.AREA,d.AREA_STACKED,d.AREA_STACKED_PERCENT,d.AREA_STEPPED,d.STREAM_GRAPH,d.COLUMN_GROUPED,d.COLUMN_STACKED,d.COLUMN_STACKED_PERCENT,d.BAR_GROUPED,d.BAR_STACKED,d.BAR_STACKED_PERCENT],fn:function(e){this.sheetIterator(e,function(e,t){this.multiSheetItem(e,t)})},fnTranspose:function(e){this.sheetIterator(e,function(e,t){this.multiSheetItemTranspose(e,t)})}},bubblePlot:{types:[d.BUBBLE_PLOT],fn:function(e){this.sheetIterator(e,function(e,t){this.multiSheetItemTranspose(e,t)})},fnTranspose:function(e){this.sheetIterator(e,function(e,t){this.multiSheetItem(e,t)})}},doubleAxis:{types:[d.COLUMN_LINE,d.LINE_LINE],fn:function(e){this.sheetIterator(e,function(e,t){this.doubleAxisSheetItem(e,t)})},fnTranspose:function(e){this.sheetIterator(e,function(e,t){this.doubleAxisSheetItemTranspose(e,t)})}},combo:{types:[d.COMBO_GROUPED,d.COMBO_STACKED],fn:function(e){this.sheetIterator(e,function(e,t){this.comboSheetItem(e,t)})},fnTranspose:function(e){this.sheetIterator(e,function(e,t){this.comboSheetItemTranspose(e,t)})}},lineErrorMargin:{types:[d.LINE_ERROR_MARGIN],fn:function(e){Object(l.default)(this).default(e)},fnTranspose:function(e){Object(l.default)(this).transposed(e)}},timer:{types:[d.TIMER],fn:function(e){this.sheetIterator(e,this.timerSheetItem)}},scatter:{types:[d.SCATTER,d.SCATTER_GROUPED,d.BUBBLE],fn:function(e){this.sheetIterator(e,function(e,t){this.scatterSheetItem(e,t)})},fnTranspose:function(e){this.sheetIterator(e,function(e,t){this.scatterSheetItemTranspose(e,t)})}},gantt:{types:[d.GANTT],fn:function(e){Object(o.default)(this).default(e)},fnTranspose:function(e){Object(o.default)(this).transposed(e)}},map:{types:[d.MAP],fn:function(e){this.sheetIterator(e,function(e,t){this.mapItem(e,t)})}},table:{types:[d.TABLE],fn:function(e){this.sheetIterator(e,function(e,t){this.tableItem(e,t)})}},FactsAndFigures:{types:[d.FACTS_AND_FIGURES],fn:function(e){var t=this;this.sheetIterator(e,function(e,a){t.FactsAndFiguresItem(e,a)})}},gauge:{types:[d.GAUGE],fn:function(e){Object(r.default)(e,this)}},candle:{types:[d.CANDLESTICK],fn:function(e){Object(c.default)(this).default(e)},fnTranspose:function(e){Object(c.default)(this).transposed(e)}}},t.default={create:function(e){return new g(e)},NumberParser:s.default}},m6Yx:function(e,t,a){"use strict";a.r(t);var i=a("LvDl"),n=a.n(i),s=a("Z8Pq");t.default=function(e,t){var a=t.emptySheet,i=t.createNumberParser,r=t.options,o=t.useAllColumns,c=r.sheets,l=r.custom;function h(e,r){var o=i.call(t,r+1),h=function(e,t){return e=o(e),isNaN(e)?t:e},u=n.a.merge({},a),f=u.series[0],d=u.categories.data=[];u.categories.title=Object(s.replaceBlank)(e[0][1],"");var p=Object(s.replaceBlank)(e[1][1],0,!0),g=h(p,0),m=Object(s.replaceBlank)(e[2][1],100,!0),v=h(m,100),b=e[3][1],y=b&&"link"===b.type,O=Object(s.replaceBlank)(y?b.value:b,50),x=h(O,50),S=Object(s.replaceBlank)(e[4][1],"",!0);d.push(S);var k={min:{label:p.toString(),value:g},max:{label:m.toString(),value:v},value:x};y&&"edit"!==n.a.get(l,"viewMode")&&(k.link=b.href),f.index=r,f.data.push(k),f.rawData.push(n.a.merge({},k,{value:O})),c.push(u)}e=Object(s.fillSheets)(e,5,2),e=Object(s.spreadSheets)(e,o),void 0===t.sheetIndex?e.forEach(function(e,t){h.call(this,e,t)},this):h.call(this,e[t.sheetIndex],t.sheetIndex)}},pLmG:function(e,t,a){"use strict";a.r(t),function(e,i){var n=a("XzT5"),s=a("Du7+"),r=function(e){return parseInt(e.ord,10)};var o=function(e,t,a){var i=e.position()[a]-t.position()[a];return i=(i>0?"+=":"-=")+Math.abs(i)+"px"};t.default={recalculateMargin:function(){var t=s.default.getMargin(),a=!1;e(".moveable_w, .undo_w").each(function(){var i=e(this).hasClass("shrink"),n=0;a&&i&&(n=t-1),n<0&&(n=0),e(this).css("margin-left",n),a=i&&!a})},removeMargin:function(t){e(t).css("margin-left","")},setPlaceholders:function(){var t,a,i,r,c,l=e(".ig-items").width(),h=[];return e(".sbs_placeholder").remove(),e(".moveable_w.shrink").each(function(){var u=e(this).width();t=!!e(this).next(".moveable_w.shrink, .undo_w.shrink").length,i=e(this).position().left+u,a=l-i,!t&&a>u&&((r=e('<div class="sbs_placeholder">')).html('<div class="sbs_placeholder_message">'),r.find(".sbs_placeholder_message").html('<p class="center_vh">'+n.default.t("app.edit.drag_here")+"</p>"),c=e(this).children(".moveable"),r.css("width",c.width()),r.height(c.height()),e(this).after(r),h.push(r.get(0)),r.on("drop",function(t){var a=t.originalEvent.dataTransfer,i=a.getData("text");if(i){var r,c=e('[data-object-id="'+i+'"]'),l=e(this),h=l.prev(),u=parseInt(c.attr("ord"),10),f=parseInt(h.attr("ord"),10),d=f+1,p=c.find(".icon-min-object");if(u<f&&(d=f),!c.is(h)){if(r=c.clone(),l.remove(),!c.hasClass("shrink")){var g=r.find(".moveable").hasClass("chart");if(g){var m=e(this).width()-s.default.getMargin();r.find(".inner").width(m)}p.trigger("click"),ga("send","event","edit","side_by_side","drag_and_drop",0),ga("App.send","event","edit","side_by_side","drag_and_drop",0)}e.ajax({url:"/api/itemorder/".concat(graphicID),headers:{"csrf-token":window.app.profile.csrfToken},data:{newpos:d,count:e(".moveable_w").length,type:c.attr("data-object-type"),object_id:c.attr("data-object-id")},type:"PUT",beforeSend:function(){window.app.events.trigger("Editable:saving")}}).done(function(){r.find(".moveable").css({"margin-left":"20px"}),r.css({position:"absolute",width:c.css("width"),"z-index":10,"margin-left":0,"margin-right":0,top:c.position().top+"px",left:c.position().left+"px"}).insertBefore(c),c.css("opacity",0),c.insertAfter(h);var t=o(c,r,"top"),a=o(c,r,"left");r.animate({top:t,left:a},{complete:function(){e(".item-insertion").remove(),r.remove(),c.css("opacity",1),window.app.events.trigger("Editable:resetOrder Editable:shrink")}})}).fail(function(){window.app.message.error(n.default.t("app.errors.order_state"))}).always(function(){window.app.events.trigger("Editable:saved")})}}}))}),h},lastInRowElements:function(){var t=[],a=[];e(".moveable_w.shrink").each(function(){a.push({id:e(this).attr("data-object-id"),top:e(this).position().top,ord:e(this).attr("ord")})});var n=i.groupBy(a,function(e){return e.top});for(var s in n)t.push(i.maxBy(n[s],r));return t},chartWidth:function(t){var a=e(".ig-items").width();return parseInt((a-2*s.default.getChartPadding()-s.default.getMargin())/t,10)},boxWidth:function(t,a){var i=e(".ig-items").width(),n=parseInt((i-s.default.getMargin())/2,10);a.css({width:n+"px"})}}}.call(this,a("+hRF"),a("LvDl"))},tcv8:function(e,t,a){"use strict";a.r(t);var i=a("LvDl"),n=a.n(i);function s(e,t){if(n.a.isEqual(t,[]))return t}t.default=function(e){var t=e.chart,a=e.sheetIndex,i=void 0===a,r=t.get("sheets_settings"),o=r[a];function c(){return t.get("colors")}return{get isCommon(){return i},getColors:function(){return i?c():o&&n.a.has(o,"colors")&&o.colors&&o.colors.length?o.colors:c()},getCustomValue:function(e,a){var s=this.getCustom();return n.a.has(s,e)?n.a.get(s,e):!i&&(s=t.get("custom"),n.a.has(s,e))?n.a.get(s,e):a},getCustom:function(){return o||t.get("custom")},getLocalisations:function(){return n.a.get(t.get("custom"),"map_json.localisations")},getCustomStrict:function(){return i?t.get("custom"):o||{}},setCustom:function(e){if(i){var c=t.get("custom");n.a.mergeWith(c,e,s)}else o||(o=r[a]={}),n.a.mergeWith(o,e,s),t.set("sheets_settings",r,{silent:!0})},removeCustom:function(e){if(i){var s=t.get("custom");e.forEach(function(e){n.a.unset(s,e)})}else o||(o=r[a]={}),e.forEach(function(e){n.a.unset(o,e)}),t.set("sheets_settings",r,{silent:!0})}}}},wUcv:function(e,t,a){"use strict";a.r(t),function(e){a.d(t,"buildXHR",function(){return r});var i=a("LvDl"),n=a.n(i),s=a("bZl7");function r(t){var a,i=t.chart,r=t.sheetIndex,o=t.applyToAllSheets,c={infographic:i.get("block_id"),applyToAllSheets:o};return void 0!==r?(c.sheet_settings_index=r,a=c.sheet_settings={}):a=c.custom={},{searchOsm:function(t){return e.ajax({url:encodeURI("https://nominatim.openstreetmap.org/search/?format=json&accept-language=en-GB,en-US&limit=1&bounded=1&q=".concat(t)),type:"GET",format:"json"})},send:function(){return n.a.has(c,"custom.groupedColors")&&(c.custom.groupedColors=n.a.toPairs(c.custom.groupedColors)),i.get("isFreelayoutInline")?e.Deferred().resolve():e.ajax({url:"/api/charts/"+i.get("object_id"),type:"PUT",data:JSON.stringify(c),contentType:"application/json; charset=utf-8",headers:{"csrf-token":s.default.profile.csrfToken}})},setCustom:function(e){return n.a.merge(a,e),this},setParams:function(e){return n.a.merge(c,e),this}}}}.call(this,a("+hRF"))},wrGL:function(e,t,a){"use strict";a.r(t),a.d(t,"defaultColorValue",function(){return r}),a.d(t,"defaultColorMethod",function(){return o}),a.d(t,"gridColor",function(){return c});var i=a("LvDl"),n=a.n(i),s=a("pWQL");function r(e,t){var a={method:"contrast",contrast:{dark:e||"#000000",light:"#ffffff"},manual:{fill:"#000000",stroke:"#ffffff"}};return"manual"===t&&(n.a.set(a,"method",t),n.a.set(a,"contrast.dark","#000000"),n.a.set(a,"manual.fill",e||"#000000")),a}function o(e){return-1!==[s.WATERFALL,s.GANTT].indexOf(e.getTypeMod())?"manual":"contrast"}function c(e,t){return n.a.get(e,"axis.color")||n.a.get(t,"charts.grid.color")||n.a.get(e,"textColor")||n.a.get(t,"color.chart.text")||n.a.get(t,"color.text")}}}]);